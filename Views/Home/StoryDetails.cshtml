@model UpliftBridge.Models.Story

@{
    var hasModel = Model != null;

    ViewData["Title"] = hasModel ? (Model!.Title ?? "Story") : "Story";
    ViewData["BodyClass"] = "kg-dark";

    var bg = Url.Content("~/images/needs/background.jpg");
    var cover = Url.Content(
        hasModel
            ? (Model!.CoverImagePath ?? "~/images/stories/story-education.jpg")
            : "~/images/stories/story-education.jpg"
    );
}

<section class="kg-detail" style="--kg-bg:url('@bg');">
    <div class="kg-wrap">
        <div class="kg-detail-grid">

@if (!hasModel)
{
            <div class="kg-glass">
                <a class="kg-pill" asp-controller="Home" asp-action="Stories">← Back</a>
                <div class="kg-kicker mt-3">Success story</div>
                <h1 class="kg-title">Story not found</h1>
                <div class="kg-muted">
                    This story may have been removed or the link is incorrect.
                </div>
            </div>
}
else
{
    var m = Model!;

            <div class="kg-glass">
                <a class="kg-pill" asp-controller="Home" asp-action="Stories">← Back</a>

                <div class="kg-kicker mt-3">Success story</div>
                <h1 class="kg-title">@m.Title</h1>

                <div class="kg-muted">
                    @m.Category • @m.Location •
                    @((m.PublishedUtc ?? m.CreatedUtc).ToString("yyyy-MM-dd"))
                </div>

                <div class="mt-3">
                    <img src="@cover"
                         alt="@m.Title"
                         style="width:100%; border-radius:18px; border:1px solid rgba(255,255,255,.12);" />
                </div>

                @if (!string.IsNullOrWhiteSpace(m.ShortSummary))
                {
                    <div class="kg-card kg-card-light mt-3">
                        <h5>Summary</h5>
                        <p>@m.ShortSummary</p>
                    </div>
                }

                <div class="kg-card kg-card-light mt-3">
                    <h5>Story</h5>
                    <p style="white-space:pre-line;">@m.Body</p>
                </div>
            </div>

            <aside class="kg-glass">
                <div class="kg-kicker">Trust & verification</div>

                <div class="mt-2">
                    <span class="kg-pill kg-pill-gold">✔ @m.VerificationLabel</span>
                </div>

                @if (!string.IsNullOrWhiteSpace(m.Tagline))
                {
                    <div class="kg-card kg-card-light mt-3">
                        <h5>Note</h5>
                        <p>@m.Tagline</p>
                    </div>
                }

                <div class="mt-3">
                    <a class="kg-btn kg-btn-gold w-100"
                       asp-controller="Needs"
                       asp-action="Index">
                        Browse needs
                    </a>
                    <div class="kg-muted mt-2" style="font-weight:700;">
                        No urgency. Take your time.
                    </div>
                </div>
            </aside>
}
        </div>
    </div>
</section>
